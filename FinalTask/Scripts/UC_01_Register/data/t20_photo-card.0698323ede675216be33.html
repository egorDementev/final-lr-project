"use strict";(self.webpackChunk_msnews_msnews_experiences=self.webpackChunk_msnews_msnews_experiences||[]).push([["photo-card"],{6642:function(t,e,i){i.r(e),i.d(e,{PhotoCard:function(){return Lt},PhotoCardStyles:function(){return ue},PhotoCardTelemetryConstants:function(){return M},PhotoCardTemplate:function(){return re},ToolingInfo:function(){return ye}});var r=i(76679),o=i(63070),a=i(25162),n=i(19292),s=i(92449),d=i(23335),c=i(71257),h=i(90610),l=i(96236),p=i(29595),g=i(51191),u=i(14318);var y,m=i(33940),f=i(53724),v=i(78254),w=i(95578),E=i(16754),b=i(62713),C=i(62512);function x(t,e){return t?.getFullYear()===e?.getFullYear()&&t?.getMonth()===e?.getMonth()&&t?.getDate()===e?.getDate()}function D(t){return(t.thumbnails??[]).map((t=>t.large?t.large:t.medium?t.medium:t.small?t.small:null)).filter((t=>t?.height&&t?.width&&t?.url)).map(((e,i)=>({webUrl:t.webUrl,alt:"",id:e.sourceItemId??String(i),height:e.height,width:e.width,url:e.url})))}function A(t){return t[Math.floor(Math.random()*(t.length-1))]}function T(t){const e=[];if(t?.length>1)t.forEach((t=>{const i=D(t)[0];e.push(i)}));else{const i=t[0],r=new RegExp(/cid=\w+/),o=i?.webUrl?.match(r),a=o?o[0]:null;let n="";t[0].thumbnails.forEach((i=>{i.large?n=i.large.sourceItemId:i.medium?n=i.medium.sourceItemId:i.small&&(n=i.small.sourceItemId);const r=(0,C.TF)($(n,a))?t[0].webUrl:$(n,a);e.push({url:i.large.url,webUrl:r})}))}return e}function $(t,e){return void 0!==t&&null!==e&&e.includes("cid")?"https://onedrive.live.com/?v=photos&"+e+"&id="+t+"&sc=photosWidget":""}function R(t,e){const i=t?.recommendation?.startDate;if(!i)return"";const r=new RegExp("Z","g"),o=i.replace(r,"");return"PreviousMonth"===t.recommendation?.recommendationType?new Date(o).toLocaleDateString(e,{month:"short"}):new Date(o).toLocaleDateString(e,{day:"numeric",month:"short"})}!function(t){t.Memories="Memories",t.MemoriesCarousel="MemoriesCarousel",t.Empty="Empty",t.Error="Error",t.RecentPhoto="RecentPhoto",t.RecentPhotosCarousel="RecentPhotosCarousel"}(y||(y={}));var S=i(39157),H=i(67396);const _="OnThisDay",O="PreviousMonth";var M;!function(t){t.PhotoCard="Photos",t.Vertical="photos",t.MOJ="Memories state",t.RecentPhoto="Recent photo state",t.EmptyState="Empty photo state",t.ErrorState="Error state",t.Collage="Memories photos button",t.SeeAll="See all button",t.ViewOnOneDrive="Recent photo button",t.GetMobileApp="Get mobile app button",t.RecommendationType="RecommendationType",t.Customization="Photoscard_customization",t.CardActionButton="CardActionButton",t.CarouselNextFlipperButton="CarouselNextFlipperButton",t.CarouselPreviousFlipperButton="CarouselPreviousFlipperButton",t.HeaderLink="Photoscard_header"}(M||(M={}));var L,P,I=i(88826),k=i(7476),U=i(23549),N=i(82898),F=i(49218),W=i(93703),z=i(79545);class G{constructor(){this.eventHandlers=[]}fire(t){for(const e of this.eventHandlers)e(t)}add(t){this.eventHandlers.push(t)}remove(t){for(let e=0;e<this.eventHandlers.length;e++)this.eventHandlers[e]===t&&(this.eventHandlers.splice(e,1),e--)}}class q{get state(){return this._state}constructor(){this._loginChangedDispatcher=new G,this._state=P.Loading}setState(t){t!==this._state&&(this._state=t,this._loginChangedDispatcher.fire(this._state))}onStateChanged(t){this._loginChangedDispatcher.add(t)}removeStateChangedHandler(t){this._loginChangedDispatcher.remove(t)}getAccessTokenForScopes(...t){return this.getAccessToken({scopes:t})}}!function(t){t[t.Popup=0]="Popup",t[t.Redirect=1]="Redirect",t[t.EdgeAuthPrivate=2]="EdgeAuthPrivate"}(L||(L={})),function(t){t[t.Loading=0]="Loading",t[t.SignedOut=1]="SignedOut",t[t.SignedIn=2]="SignedIn"}(P||(P={}));var B;function j(t,e,i,r){return new(i||(i=Promise))((function(o,a){function n(t){try{d(r.next(t))}catch(t){a(t)}}function s(t){try{d(r.throw(t))}catch(t){a(t)}}function d(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(n,s)}d((r=r.apply(t,e||[])).next())}))}!function(t){t.GET="GET",t.PATCH="PATCH",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE"}(B||(B={}));class V{constructor(t){if(this.requests=new Map,void 0!==t){const e=V.requestLimit;if(t.length>e){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${e}`);throw t.name="Limit Exceeded Error",t}for(const e of t)this.addRequest(e)}}static validateDependencies(t){if(0===t.size){const t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return(t=>{const e=t.entries();let i=e.next();for(;!i.done;){const t=i.value[1];if(void 0!==t.dependsOn&&t.dependsOn.length>0)return!1;i=e.next()}return!0})(t)||(t=>{const e=t.entries();let i=e.next();const r=i.value[1];if(void 0!==r.dependsOn&&r.dependsOn.length>0)return!1;let o=i;for(i=e.next();!i.done;){const t=i.value[1];if(void 0===t.dependsOn||1!==t.dependsOn.length||t.dependsOn[0]!==o.value[1].id)return!1;o=i,i=e.next()}return!0})(t)||(t=>{const e=t.entries();let i=e.next();const r=i.value[1];let o;if(void 0===r.dependsOn||0===r.dependsOn.length)o=r.id;else{if(1!==r.dependsOn.length)return!1;{const e=r.dependsOn[0];if(e===r.id||!t.has(e))return!1;o=e}}for(i=e.next();!i.done;){const t=i.value[1];if((void 0===t.dependsOn||0===t.dependsOn.length)&&o!==t.id)return!1;if(void 0!==t.dependsOn&&0!==t.dependsOn.length){if(1===t.dependsOn.length&&(t.id===o||t.dependsOn[0]!==o))return!1;if(t.dependsOn.length>1)return!1}i=e.next()}return!0})(t)}static getRequestData(t){return j(this,void 0,void 0,(function*(){const e={url:""},i=new RegExp("^https?://");e.url=i.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,e.method=t.method;const r={};return t.headers.forEach(((t,e)=>{r[e]=t})),Object.keys(r).length&&(e.headers=r),t.method!==B.PATCH&&t.method!==B.POST&&t.method!==B.PUT||(e.body=yield V.getRequestBody(t)),e}))}static getRequestBody(t){return j(this,void 0,void 0,(function*(){let e,i=!1;try{const r=t.clone();e=yield r.json(),i=!0}catch(t){}if(!i)try{if("undefined"!=typeof Blob){const i=yield t.blob(),r=new FileReader;e=yield new Promise((t=>{r.addEventListener("load",(()=>{const e=r.result,i=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(e);t(i[4])}),!1),r.readAsDataURL(i)}))}else if("undefined"!=typeof Buffer){e=(yield t.buffer()).toString("base64")}i=!0}catch(t){}return e}))}addRequest(t){const e=V.requestLimit;if(""===t.id){const t=new Error("Id for a request is empty, Please provide an unique id");throw t.name="Empty Id For Request",t}if(this.requests.size===e){const t=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${e}`);throw t.name="Limit Exceeded Error",t}if(this.requests.has(t.id)){const e=new Error(`Adding request with duplicate id ${t.id}, Make the id of the requests unique`);throw e.name="Duplicate RequestId Error",e}return this.requests.set(t.id,t),t.id}removeRequest(t){const e=this.requests.delete(t),i=this.requests.entries();let r=i.next();for(;!r.done;){const e=r.value[1].dependsOn;if(void 0!==e){const i=e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&delete r.value[1].dependsOn}r=i.next()}return e}getContent(){return j(this,void 0,void 0,(function*(){const t=[],e={requests:t},i=this.requests.entries();let r=i.next();if(r.done){const t=new Error("No requests added yet, Please add at least one request.");throw t.name="Empty Payload",t}if(!V.validateDependencies(this.requests)){const t=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw t.name="Invalid Dependency",t}for(;!r.done;){const e=r.value[1],o=yield V.getRequestData(e.request);if(void 0!==o.body&&(void 0===o.headers||void 0===o.headers["content-type"])){const t=new Error(`Content-type header is not mentioned for request #${e.id}, For request having body, Content-type header should be mentioned`);throw t.name="Invalid Content-type header",t}o.id=e.id,void 0!==e.dependsOn&&e.dependsOn.length>0&&(o.dependsOn=e.dependsOn),t.push(o),r=i.next()}return e.requests=t,e}))}addDependency(t,e){if(!this.requests.has(t)){const e=new Error(`Dependent ${t} does not exists, Please check the id`);throw e.name="Invalid Dependent",e}if(void 0!==e&&!this.requests.has(e)){const t=new Error(`Dependency ${e} does not exists, Please check the id`);throw t.name="Invalid Dependency",t}if(void 0!==e){const i=this.requests.get(t);if(void 0===i.dependsOn&&(i.dependsOn=[]),-1!==i.dependsOn.indexOf(e)){const i=new Error(`Dependency ${e} is already added for the request ${t}`);throw i.name="Duplicate Dependency",i}i.dependsOn.push(e)}else{const i=this.requests.entries();let r,o=i.next();for(;!o.done&&o.value[1].id!==t;)r=o,o=i.next();if(void 0===r){const t=new Error(`Can't add dependency ${e}, There is only a dependent request in the batch`);throw t.name="Invalid Dependency Addition",t}{const e=r.value[0];if(void 0===o.value[1].dependsOn&&(o.value[1].dependsOn=[]),-1!==o.value[1].dependsOn.indexOf(e)){const i=new Error(`Dependency ${e} is already added for the request ${t}`);throw i.name="Duplicate Dependency",i}o.value[1].dependsOn.push(e)}}}removeDependency(t,e){const i=this.requests.get(t);if(void 0===i||void 0===i.dependsOn||0===i.dependsOn.length)return!1;if(void 0!==e){const t=i.dependsOn.indexOf(e);return-1!==t&&(i.dependsOn.splice(t,1),!0)}return delete i.dependsOn,!0}}V.requestLimit=20;class X{constructor(t=[]){this.middlewareOptions=new Map;for(const e of t){const t=e.constructor;this.middlewareOptions.set(t,e)}}getMiddlewareOptions(t){return this.middlewareOptions.get(t)}setMiddlewareOptions(t,e){this.middlewareOptions.set(t,e)}}const Q=(t,e,i)=>{let r=null;if("undefined"!=typeof Request&&t instanceof Request)r=t.headers.get(i);else if(void 0!==e&&void 0!==e.headers)if("undefined"!=typeof Headers&&e.headers instanceof Headers)r=e.headers.get(i);else if(e.headers instanceof Array){const t=e.headers;for(let e=0,o=t.length;e<o;e++)if(t[e][0]===i){r=t[e][1];break}}else void 0!==e.headers[i]&&(r=e.headers[i]);return r},Y=(t,e,i,r)=>{if("undefined"!=typeof Request&&t instanceof Request)t.headers.set(i,r);else if(void 0!==e)if(void 0===e.headers)e.headers=new Headers({[i]:r});else if("undefined"!=typeof Headers&&e.headers instanceof Headers)e.headers.set(i,r);else if(e.headers instanceof Array){let t=0;const o=e.headers.length;for(;t<o;t++){const o=e.headers[t];if(o[0]===i){o[1]=r;break}}t===o&&e.headers.push([i,r])}else Object.assign(e.headers,{[i]:r})},J=(t,e,i,r)=>{"undefined"!=typeof Request&&t instanceof Request?t.headers.append(i,r):void 0!==e&&(void 0===e.headers?e.headers=new Headers({[i]:r}):"undefined"!=typeof Headers&&e.headers instanceof Headers?e.headers.append(i,r):e.headers instanceof Array?e.headers.push([i,r]):void 0===e.headers?e.headers={[i]:r}:void 0===e.headers[i]?e.headers[i]=r:e.headers[i]+=`, ${r}`)};class Z{constructor(t,e){this.authenticationProvider=t,this.authenticationProviderOptions=e}}var K;!function(t){t[t.NONE=0]="NONE",t[t.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",t[t.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",t[t.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(K||(K={}));class tt{constructor(){this.featureUsage=K.NONE}static updateFeatureUsageFlag(t,e){let i;t.middlewareControl instanceof X?i=t.middlewareControl.getMiddlewareOptions(tt):t.middlewareControl=new X,void 0===i&&(i=new tt,t.middlewareControl.setMiddlewareOptions(tt,i)),i.setFeatureUsage(e)}setFeatureUsage(t){this.featureUsage=this.featureUsage|t}getFeatureUsage(){return this.featureUsage.toString(16)}}class et{constructor(t){this.authenticationProvider=t}execute(t){return j(this,void 0,void 0,(function*(){try{let e,i,r;t.middlewareControl instanceof X&&(e=t.middlewareControl.getMiddlewareOptions(Z)),void 0!==e&&(i=e.authenticationProvider,r=e.authenticationProviderOptions),void 0===i&&(i=this.authenticationProvider);const o=`Bearer ${yield i.getAccessToken(r)}`;return J(t.request,t.options,et.AUTHORIZATION_HEADER,o),tt.updateFeatureUsageFlag(t,K.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(t)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}et.AUTHORIZATION_HEADER="Authorization";class it{execute(t){return j(this,void 0,void 0,(function*(){try{return void(t.response=yield fetch(t.request,t.options))}catch(t){throw t}}))}}class rt{constructor(t=rt.DEFAULT_DELAY,e=rt.DEFAULT_MAX_RETRIES,i=rt.DEFAULT_SHOULD_RETRY){if(t>rt.MAX_DELAY&&e>rt.MAX_MAX_RETRIES){const t=new Error(`Delay and MaxRetries should not be more than ${rt.MAX_DELAY} and ${rt.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t>rt.MAX_DELAY){const t=new Error(`Delay should not be more than ${rt.MAX_DELAY}`);throw t.name="MaxLimitExceeded",t}if(e>rt.MAX_MAX_RETRIES){const t=new Error(`MaxRetries should not be more than ${rt.MAX_MAX_RETRIES}`);throw t.name="MaxLimitExceeded",t}if(t<0&&e<0){const t=new Error("Delay and MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}if(t<0){const t=new Error("Delay should not be negative");throw t.name="MinExpectationNotMet",t}if(e<0){const t=new Error("MaxRetries should not be negative");throw t.name="MinExpectationNotMet",t}this.delay=Math.min(t,rt.MAX_DELAY),this.maxRetries=Math.min(e,rt.MAX_MAX_RETRIES),this.shouldRetry=i}getMaxDelay(){return rt.MAX_DELAY}}rt.DEFAULT_DELAY=3,rt.DEFAULT_MAX_RETRIES=3,rt.MAX_DELAY=180,rt.MAX_MAX_RETRIES=10,rt.DEFAULT_SHOULD_RETRY=()=>!0;class ot{constructor(t=new rt){this.options=t}isRetry(t){return-1!==ot.RETRY_STATUS_CODES.indexOf(t.status)}isBuffered(t,e){const i="string"==typeof t?e.method:t.method;if(i===B.PUT||i===B.PATCH||i===B.POST){if("application/octet-stream"===Q(t,e,"Content-Type"))return!1}return!0}getDelay(t,e,i){const r=()=>Number(Math.random().toFixed(3)),o=void 0!==t.headers?t.headers.get(ot.RETRY_AFTER_HEADER):null;let a;return a=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):e>=2?this.getExponentialBackOffTime(e)+i+r():i+r(),Math.min(a,this.options.getMaxDelay()+r())}getExponentialBackOffTime(t){return Math.round(.5*(Math.pow(2,t)-1))}sleep(t){return j(this,void 0,void 0,(function*(){const e=1e3*t;return new Promise((t=>setTimeout(t,e)))}))}getOptions(t){let e;return t.middlewareControl instanceof X&&(e=t.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===e&&(e=Object.assign(new rt,this.options)),e}executeWithRetry(t,e,i){return j(this,void 0,void 0,(function*(){try{if(yield this.nextMiddleware.execute(t),e<i.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&i.shouldRetry(i.delay,e,t.request,t.options,t.response)){++e,Y(t.request,t.options,ot.RETRY_ATTEMPT_HEADER,e.toString());const r=this.getDelay(t.response,e,i.delay);return yield this.sleep(r),yield this.executeWithRetry(t,e,i)}return}catch(t){throw t}}))}execute(t){return j(this,void 0,void 0,(function*(){try{const e=0,i=this.getOptions(t);return tt.updateFeatureUsageFlag(t,K.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(t,e,i)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}ot.RETRY_STATUS_CODES=[429,503,504],ot.RETRY_ATTEMPT_HEADER="Retry-Attempt",ot.RETRY_AFTER_HEADER="Retry-After";class at{constructor(t=at.DEFAULT_MAX_REDIRECTS,e=at.DEFAULT_SHOULD_RETRY){if(t>at.MAX_MAX_REDIRECTS){const t=new Error(`MaxRedirects should not be more than ${at.MAX_MAX_REDIRECTS}`);throw t.name="MaxLimitExceeded",t}if(t<0){const t=new Error("MaxRedirects should not be negative");throw t.name="MinExpectationNotMet",t}this.maxRedirects=t,this.shouldRedirect=e}}at.DEFAULT_MAX_REDIRECTS=5,at.MAX_MAX_REDIRECTS=20,at.DEFAULT_SHOULD_RETRY=()=>!0;class nt{constructor(t=new at){this.options=t}isRedirect(t){return-1!==nt.REDIRECT_STATUS_CODES.indexOf(t.status)}hasLocationHeader(t){return t.headers.has(nt.LOCATION_HEADER)}getLocationHeader(t){return t.headers.get(nt.LOCATION_HEADER)}isRelativeURL(t){return-1===t.indexOf("://")}shouldDropAuthorizationHeader(t,e){const i=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,r=i.exec(t);let o,a;null!==r&&(o=r[0]);const n=i.exec(e);return null!==n&&(a=n[0]),void 0!==o&&void 0!==a&&o!==a}updateRequestUrl(t,e){return j(this,void 0,void 0,(function*(){var i,r;e.request="string"==typeof e.request?t:yield(i=t,r=e.request,j(void 0,void 0,void 0,(function*(){const t=r.headers.get("Content-Type")?yield r.blob():yield Promise.resolve(void 0),{method:e,headers:o,referrer:a,referrerPolicy:n,mode:s,credentials:d,cache:c,redirect:h,integrity:l,keepalive:p,signal:g}=r;return new Request(i,{method:e,headers:o,body:t,referrer:a,referrerPolicy:n,mode:s,credentials:d,cache:c,redirect:h,integrity:l,keepalive:p,signal:g})})))}))}getOptions(t){let e;return t.middlewareControl instanceof X&&(e=t.middlewareControl.getMiddlewareOptions(at)),void 0===e&&(e=Object.assign(new at,this.options)),e}executeWithRedirect(t,e,i){return j(this,void 0,void 0,(function*(){try{yield this.nextMiddleware.execute(t);const r=t.response;if(!(e<i.maxRedirects&&this.isRedirect(r)&&this.hasLocationHeader(r)&&i.shouldRedirect(r)))return;if(++e,r.status===nt.STATUS_CODE_SEE_OTHER)t.options.method=B.GET,delete t.options.body;else{const e=this.getLocationHeader(r);!this.isRelativeURL(e)&&this.shouldDropAuthorizationHeader(r.url,e)&&Y(t.request,t.options,nt.AUTHORIZATION_HEADER,void 0),yield this.updateRequestUrl(e,t)}yield this.executeWithRedirect(t,e,i)}catch(t){throw t}}))}execute(t){return j(this,void 0,void 0,(function*(){try{const e=0,i=this.getOptions(t);return t.options.redirect=nt.MANUAL_REDIRECT,tt.updateFeatureUsageFlag(t,K.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(t,e,i)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}nt.REDIRECT_STATUS_CODES=[301,302,303,307,308],nt.STATUS_CODE_SEE_OTHER=303,nt.LOCATION_HEADER="Location",nt.AUTHORIZATION_HEADER="Authorization",nt.MANUAL_REDIRECT="manual";class st{execute(t){return j(this,void 0,void 0,(function*(){try{let e=Q(t.request,t.options,st.CLIENT_REQUEST_ID_HEADER);null===e&&(e=(()=>{let t="";for(let e=0;e<32;e++)8!==e&&12!==e&&16!==e&&20!==e||(t+="-"),t+=Math.floor(16*Math.random()).toString(16);return t})(),Y(t.request,t.options,st.CLIENT_REQUEST_ID_HEADER,e));let i,r=`${st.PRODUCT_NAME}/2.0.0`;if(t.middlewareControl instanceof X&&(i=t.middlewareControl.getMiddlewareOptions(tt)),void 0!==i){const t=i.getFeatureUsage();r+=` (${st.FEATURE_USAGE_STRING}=${t})`}return J(t.request,t.options,st.SDK_VERSION_HEADER,r),yield this.nextMiddleware.execute(t)}catch(t){throw t}}))}setNext(t){this.nextMiddleware=t}}st.CLIENT_REQUEST_ID_HEADER="client-request-id",st.SDK_VERSION_HEADER="SdkVersion",st.PRODUCT_NAME="graph-js",st.FEATURE_USAGE_STRING="featureUsage";class dt{constructor(t=-1,e=-1){this.minValue=t,this.maxValue=e}}class ct{constructor(t,e,i,r={}){this.DEFAULT_FILE_SIZE=5242880,this.client=t,this.file=e,void 0===r.rangeSize&&(r.rangeSize=this.DEFAULT_FILE_SIZE),this.options=r,this.uploadSession=i,this.nextRange=new dt(0,this.options.rangeSize-1)}static createUploadSession(t,e,i,r={}){return j(this,void 0,void 0,(function*(){try{const o=yield t.api(e).headers(r).post(i);return{url:o.uploadUrl,expiry:new Date(o.expirationDateTime)}}catch(t){throw t}}))}parseRange(t){const e=t[0];if(void 0===e||""===e)return new dt;const i=e.split("-"),r=parseInt(i[0],10);let o=parseInt(i[1],10);return Number.isNaN(o)&&(o=this.file.size-1),new dt(r,o)}updateTaskStatus(t){this.uploadSession.expiry=new Date(t.expirationDateTime),this.nextRange=this.parseRange(t.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const t=this.nextRange.minValue;let e=t+this.options.rangeSize-1;return e>=this.file.size&&(e=this.file.size-1),new dt(t,e)}sliceFile(t){return this.file.content.slice(t.minValue,t.maxValue+1)}upload(){return j(this,void 0,void 0,(function*(){try{for(;;){const t=this.getNextRange();if(-1===t.maxValue){const t=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw t.name="Invalid Session",t}const e=this.sliceFile(t),i=yield this.uploadSlice(e,t,this.file.size);if(void 0!==i.id)return i;this.updateTaskStatus(i)}}catch(t){throw t}}))}uploadSlice(t,e,i){return j(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(e.maxValue-e.minValue+1),"Content-Range":`bytes ${e.minValue}-${e.maxValue}/${i}`}).put(t)}catch(t){throw t}}))}cancel(){return j(this,void 0,void 0,(function*(){try{return yield this.client.api(this.uploadSession.url).delete()}catch(t){throw t}}))}getStatus(){return j(this,void 0,void 0,(function*(){try{const t=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(t),t}catch(t){throw t}}))}resume(){return j(this,void 0,void 0,(function*(){try{return yield this.getStatus(),yield this.upload()}catch(t){throw t}}))}}const ht=(t=5242880)=>{const e=62914560;return t>e&&(t=e),(i=t)>327680&&(i=320*Math.floor(i/327680)*1024),i;var i};class lt extends ct{constructor(t,e,i,r){super(t,e,i,r)}static constructCreateSessionUrl(t,e=lt.DEFAULT_UPLOAD_PATH){return t=t.trim(),""===(e=e.trim())&&(e="/"),"/"!==e[0]&&(e=`/${e}`),"/"!==e[e.length-1]&&(e=`${e}/`),encodeURI(`/me/drive/root:${e}${t}:/createUploadSession`)}static create(t,e,i){return j(this,void 0,void 0,(function*(){const r=i.fileName;let o,a;if("undefined"!=typeof Blob&&e instanceof Blob)o=new File([e],r),a=o.size;else if("undefined"!=typeof File&&e instanceof File)o=e,a=o.size;else if("undefined"!=typeof Buffer&&e instanceof Buffer){const t=e;a=t.byteLength-t.byteOffset,o=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}try{const e=lt.constructCreateSessionUrl(i.fileName,i.path),n=yield lt.createUploadSession(t,e,i.fileName),s=ht(i.rangeSize);return new lt(t,{name:r,content:o,size:a},n,{rangeSize:s})}catch(t){throw t}}))}static createUploadSession(t,e,i){const r=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return j(this,void 0,void 0,(function*(){const o={item:{"@microsoft.graph.conflictBehavior":"rename",name:i}};try{return r.createUploadSession.call(this,t,e,o)}catch(t){throw t}}))}commit(t){return j(this,void 0,void 0,(function*(){try{const e={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(t).put(e)}catch(t){throw t}}))}}lt.DEFAULT_UPLOAD_PATH="/";class pt{constructor(t){this.provider=t}getAccessToken(){return j(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{this.provider(((i,r)=>{r?t(r):e(i)}))}))}))}}class gt{constructor(t=-1){this.statusCode=t,this.code=null,this.message=null,this.requestId=null,this.date=new Date,this.body=null}}class ut{static constructError(t,e){const i=new gt(e);return void 0!==t.name&&(i.code=t.name),i.body=t.toString(),i.message=t.message,i.date=new Date,i}static constructErrorFromResponse(t,e){t=t.error;const i=new gt(e);i.code=t.code,i.message=t.message,void 0!==t.innerError&&(i.requestId=t.innerError["request-id"],i.date=new Date(t.innerError.date));try{i.body=JSON.stringify(t)}catch(t){}return i}static getError(t=null,e=-1,i){return j(this,void 0,void 0,(function*(){let r;if(r=t&&t.error?ut.constructErrorFromResponse(t,e):"undefined"!=typeof Error&&t instanceof Error?ut.constructError(t,e):new gt(e),"function"!=typeof i)return r;i(r,null)}))}}const yt=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],mt=t=>{const e=t.constructor.name;if("Buffer"===e||"Blob"===e||"File"===e||"FormData"===e||"string"==typeof t)return t;if("ArrayBuffer"===e)t=Buffer.from(t);else if("Int8Array"===e||"Int16Array"===e||"Int32Array"===e||"Uint8Array"===e||"Uint16Array"===e||"Uint32Array"===e||"Uint8ClampedArray"===e||"Float32Array"===e||"Float64Array"===e||"DataView"===e)t=Buffer.from(t.buffer);else try{t=JSON.stringify(t)}catch(t){throw new Error("Unable to stringify the content")}return t};var ft,vt,wt,Et;!function(t){t.ARRAYBUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.RAW="raw",t.STREAM="stream",t.TEXT="text"}(ft||(ft={})),function(t){t.TEXT_HTML="text/html",t.TEXT_XML="text/xml",t.APPLICATION_XML="application/xml",t.APPLICATION_XHTML="application/xhtml+xml"}(vt||(vt={})),function(t){t.TEXT_PLAIN="text/plain",t.APPLICATION_JSON="application/json"}(wt||(wt={})),function(t){t.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",t.IMAGE="^image\\/.+"}(Et||(Et={}));class bt{static parseDocumentResponse(t,e){try{return"undefined"!=typeof DOMParser?new Promise(((i,r)=>{t.text().then((t=>{try{const r=(new DOMParser).parseFromString(t,e);i(r)}catch(t){r(t)}}))})):Promise.resolve(t.body)}catch(t){throw t}}static convertResponse(t,e){return j(this,void 0,void 0,(function*(){if(204===t.status)return Promise.resolve();let i;try{switch(e){case ft.ARRAYBUFFER:i=yield t.arrayBuffer();break;case ft.BLOB:i=yield t.blob();break;case ft.DOCUMENT:i=yield bt.parseDocumentResponse(t,vt.TEXT_XML);break;case ft.JSON:i=yield t.json();break;case ft.STREAM:i=yield Promise.resolve(t.body);break;case ft.TEXT:i=yield t.text();break;default:const e=t.headers.get("Content-type");if(null!==e){const r=e.split(";")[0];i=new RegExp(Et.DOCUMENT).test(r)?yield bt.parseDocumentResponse(t,r):new RegExp(Et.IMAGE).test(r)?t.blob():r===wt.TEXT_PLAIN?yield t.text():r===wt.APPLICATION_JSON?yield t.json():Promise.resolve(t.body)}else i=Promise.resolve(t.body)}}catch(t){throw t}return i}))}static getResponse(t,e,i){return j(this,void 0,void 0,(function*(){try{if(e===ft.RAW)return Promise.resolve(t);{const r=yield bt.convertResponse(t,e);if(!t.ok)throw r;if("function"!=typeof i)return r;i(null,r)}}catch(t){throw t}}))}}class Ct{constructor(t,e,i){this.parsePath=t=>{if(-1!==t.indexOf("https://")){const e=(t=t.replace("https://","")).indexOf("/");-1!==e&&(this.urlComponents.host="https://"+t.substring(0,e),t=t.substring(e+1,t.length));const i=t.indexOf("/");-1!==i&&(this.urlComponents.version=t.substring(0,i),t=t.substring(i+1,t.length))}"/"===t.charAt(0)&&(t=t.substr(1));const e=t.indexOf("?");if(-1===e)this.urlComponents.path=t;else{this.urlComponents.path=t.substr(0,e);const i=t.substring(e+1,t.length).split("&");for(const t of i){const e=t.split("="),i=e[0],r=e[1];-1!==yt.indexOf(i)?this.urlComponents.oDataQueryParams[i]=r:this.urlComponents.otherURLQueryParams[i]=r}}},this.httpClient=t,this.config=e,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{}},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(i)}addCsvQueryParameter(t,e,i){this.urlComponents.oDataQueryParams[t]=this.urlComponents.oDataQueryParams[t]?this.urlComponents.oDataQueryParams[t]+",":"";let r=[];i.length>1&&"string"==typeof e?r=Array.prototype.slice.call(i):"string"==typeof e?r.push(e):r=r.concat(e),this.urlComponents.oDataQueryParams[t]+=r.join(",")}buildFullUrl(){const t=(t=>{const e=t=>t.replace(/^\/+/,"");return Array.prototype.slice.call(t).reduce(((t,i)=>{return[(r=t,r.replace(/\/+$/,"")),e(i)].join("/");var r}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(t),t}createQueryString(){const t=this.urlComponents,e=[];if(0!==Object.keys(t.oDataQueryParams).length)for(const i in t.oDataQueryParams)t.oDataQueryParams.hasOwnProperty(i)&&e.push(i+"="+t.oDataQueryParams[i]);if(0!==Object.keys(t.otherURLQueryParams).length)for(const i in t.otherURLQueryParams)t.otherURLQueryParams.hasOwnProperty(i)&&e.push(i+"="+t.otherURLQueryParams[i]);return e.length>0?"?"+e.join("&"):""}updateRequestOptions(t){const e=Object.assign({},t.headers);if(void 0!==this.config.fetchOptions){const e=Object.assign({},this.config.fetchOptions);Object.assign(t,e),void 0!==typeof this.config.fetchOptions.headers&&(t.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(t,this._options),void 0!==t.headers&&Object.assign(e,t.headers),Object.assign(e,this._headers),t.headers=e}send(t,e,i){return j(this,void 0,void 0,(function*(){let r;const o=new X(this._middlewareOptions);this.updateRequestOptions(e);try{r=(yield this.httpClient.sendRequest({request:t,options:e,middlewareControl:o})).response;return yield bt.getResponse(r,this._responseType,i)}catch(t){let e;void 0!==r&&(e=r.status);throw yield ut.getError(t,e,i)}}))}header(t,e){return this._headers[t]=e,this}headers(t){for(const e in t)t.hasOwnProperty(e)&&(this._headers[e]=t[e]);return this}option(t,e){return this._options[t]=e,this}options(t){for(const e in t)t.hasOwnProperty(e)&&(this._options[e]=t[e]);return this}middlewareOptions(t){return this._middlewareOptions=t,this}version(t){return this.urlComponents.version=t,this}responseType(t){return this._responseType=t,this}select(t){return this.addCsvQueryParameter("$select",t,arguments),this}expand(t){return this.addCsvQueryParameter("$expand",t,arguments),this}orderby(t){return this.addCsvQueryParameter("$orderby",t,arguments),this}filter(t){return this.urlComponents.oDataQueryParams.$filter=t,this}search(t){return this.urlComponents.oDataQueryParams.$search=t,this}top(t){return this.urlComponents.oDataQueryParams.$top=t,this}skip(t){return this.urlComponents.oDataQueryParams.$skip=t,this}skipToken(t){return this.urlComponents.oDataQueryParams.$skipToken=t,this}count(t){return this.urlComponents.oDataQueryParams.$count=t.toString(),this}query(t){const e=this.urlComponents.otherURLQueryParams;if("string"==typeof t){const i=t.split("="),r=i[0],o=i[1];e[r]=o}else for(const i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return this}get(t){return j(this,void 0,void 0,(function*(){const e=this.buildFullUrl(),i={method:B.GET};try{return yield this.send(e,i,t)}catch(t){throw t}}))}post(t,e){return j(this,void 0,void 0,(function*(){const i=this.buildFullUrl(),r={method:B.POST,body:mt(t),headers:"undefined"!=typeof FormData&&t instanceof FormData?{}:{"Content-Type":"application/json"}};try{return yield this.send(i,r,e)}catch(t){throw t}}))}create(t,e){return j(this,void 0,void 0,(function*(){try{return yield this.post(t,e)}catch(t){throw t}}))}put(t,e){return j(this,void 0,void 0,(function*(){const i=this.buildFullUrl(),r={method:B.PUT,body:mt(t),headers:{"Content-Type":"application/json"}};try{return yield this.send(i,r,e)}catch(t){throw t}}))}patch(t,e){return j(this,void 0,void 0,(function*(){const i=this.buildFullUrl(),r={method:B.PATCH,body:mt(t),headers:{"Content-Type":"application/json"}};try{return yield this.send(i,r,e)}catch(t){throw t}}))}update(t,e){return j(this,void 0,void 0,(function*(){try{return yield this.patch(t,e)}catch(t){throw t}}))}delete(t){return j(this,void 0,void 0,(function*(){const e=this.buildFullUrl(),i={method:B.DELETE};try{return yield this.send(e,i,t)}catch(t){throw t}}))}del(t){return j(this,void 0,void 0,(function*(){try{return yield this.delete(t)}catch(t){throw t}}))}getStream(t){return j(this,void 0,void 0,(function*(){const e=this.buildFullUrl(),i={method:B.GET};this.responseType(ft.STREAM);try{return yield this.send(e,i,t)}catch(t){throw t}}))}putStream(t,e){return j(this,void 0,void 0,(function*(){const i=this.buildFullUrl(),r={method:B.PUT,headers:{"Content-Type":"application/octet-stream"},body:t};try{return yield this.send(i,r,e)}catch(t){throw t}}))}}class xt{constructor(t){this.middleware=t}sendRequest(t){return j(this,void 0,void 0,(function*(){try{if("string"==typeof t.request&&void 0===t.options){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(t),t}catch(t){throw t}}))}}class Dt{static createWithAuthenticationProvider(t){const e=new et(t),i=new ot(new rt),r=new st,o=new it;if(e.setNext(i),new Function("try {return this === global;}catch(e){return false;}")()){const t=new nt(new at);i.setNext(t),t.setNext(r)}else i.setNext(r);return r.setNext(o),Dt.createWithMiddleware(e)}static createWithMiddleware(t){return new xt(t)}}class At{constructor(t){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"};try{(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const t=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof Promise){const t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){const t=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}})()}catch(t){throw t}for(const e in t)t.hasOwnProperty(e)&&(this.config[e]=t[e]);let e;if(void 0!==t.authProvider&&void 0!==t.middleware){const t=new Error;throw t.name="AmbiguityInInitialization",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",t}if(void 0!==t.authProvider)e=Dt.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",t}e=new xt(t.middleware)}this.httpClient=e}static init(t){const e={};for(const i in t)t.hasOwnProperty(i)&&(e[i]="authProvider"===i?new pt(t[i]):t[i]);return At.initWithMiddleware(e)}static initWithMiddleware(t){try{return new At(t)}catch(t){throw t}}api(t){return new Ct(this.httpClient,this.config,t)}}function Tt(...t){const e=t[0];let i=e;for(let e=1;e<t.length;++e){const r=t[e];i.setNext&&i.setNext(r),i=r}return e}class $t{get client(){return this._client}get version(){return this._version}constructor(t,e="v1.0"){this._client=t,this._version=e}api(t){const e=this._client.api(t).version(this._version);return e.middlewareOptions=t=>{const i=e;return i._middlewareOptions=i._middlewareOptions.concat(t),e},e}}function Rt(t,e){const i=[new et(t),new ot(new rt),new st,new it],r=At.initWithMiddleware({middleware:Tt(...i)});return new $t(r,e)}class St extends q{constructor(t,e,i){super(),this._getAccessTokenHandler=t,this._loginHandler=e,this._logoutHandler=i,this.graph=Rt(this)}getAccessToken(t){return this._getAccessTokenHandler(t.scopes)}login(){return this._loginHandler()}logout(){return this._logoutHandler()}}class Ht{constructor(t,e){this.config=t,this.displayLocale=e}async fetchRecommendedItemsDataAsync(){const{clientId:t,scope:e,resource:i,apiVersion:r}=this.config.photoCardDataServiceClientSettings,o=await(0,v.Jc)(t,e,i,r),a=o&&o.token;if(!a)return null;try{const t=Rt(new St((()=>new Promise((t=>{t(a)})))),"v1.0"),e=new Date,i=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`;return await t.api("me/drive/recommendedItemsConsumer?$expand=thumbnails&targetDate="+i).headers({"Accept-Language":this.displayLocale,Prefer:"windowsPhotoWidget"}).middlewareOptions(function(...t){return[new Z(void 0,{scopes:t})]}(this.config.photoCardDataServiceClientSettings.scope)).get()}catch(t){if(404===t.statusCode||403===t.statusCode)return{value:[]};const e=`accountType:${await(0,v.FK)()}, token:${a.substring(0,6)}******, error:${JSON.stringify(t)}`;return(0,I.OO)(t,k.jE,"Error while request photos data with exception",e),null}}}var _t=i(78951),Ot=i(78346),Mt=i(99452);class Lt extends Ot.l{constructor(){super(...arguments),this.displayLocale=S.jG.CurrentMarket,this.collageHeight=Lt.MEDIUM_COLLAGE_HEIGHT,this.collageWidth=Lt.WIDGET_WIDTH,this.widgetHeight=Lt.MEDIUM_WIDGET_HEIGHT,this.contentGridRowStart=5,this.widgetWidth=Lt.WIDGET_WIDTH,this.gridHeaderHeight=Lt.GRID_HEADER_HEIGHT,this.gridHeaderPadding=Lt.GRID_HEADER_PADDING,this.isActionMenuOpen=!1,this.indexedDBkey="",this.localizedEmptyCtaUrl="",this.isOffline=!1,this.webUrlList=[],this.activeTabIndex=0,this.lifecycleChangeEventHandlerAsync=async t=>{switch(t){case"resumed":case"suspending":this.resetIntervalTimer();break;case"removing":try{await(this.indexedDb?.clearObjects())}catch(t){(0,I.OO)(t,k.GB4,`Failed to clear cache, indexedDBkey: "${this.indexedDBkey}"`,JSON.stringify(t))}}},this.propertiesChangeEventHandler=t=>{switch(t){case"colorMode":this.colorMode=this.propertiesApi?.getProperty("colorMode")??this.colorMode,this.backgroundColor="dark"===this.colorMode?"#2C2C2C":"#FFFFFF",this.parentElement?.setAttribute("fill-color","dark"===this.colorMode?"#2C2C2C":"#FFFFFF");break;case"displayLocale":this.displayLocale=this.propertiesApi?.getProperty("displayLocale")??this.displayLocale,this.config.emptyState.callToActionURL=(0,C.WU)(this.localizedEmptyCtaUrl,this.displayLocale);break;case"offline":this.isOffline=this.propertiesApi?.getProperty("offline")??this.isOffline}},this.sizeChangeEventHandler=(t,e)=>{"onSizeChangeEnd"===t&&(this.updateWidgetHeightToWidgetSize(e),this.generateTelemetryTags((0,f.$x)(e,this.position,this.col)))},this.interactionsHandler=t=>{"settingsInteracted"===t&&(this.seeMoreButton||(this.seeMoreButton=(0,f.vh)("photos")),U.M0.sendActionEvent(this.seeMoreButton,N.Aw.Click,N.wu.More)),"widgetPositionUpdated"===t&&(this.position=this.propertiesApi?.getProperty("position"),this.col=this.propertiesApi?.getProperty("column"),this.generateTelemetryTags((0,f.$x)(this.config.isDynamicFeed?this.cardSize:this.sizesApi?.getSize(),this.position,this.col)))},this.visibilityChangeEventHandler=t=>{"visible"===t&&this.isConnected&&this.initializePhotoCard()}}static{this.FALLBACK_RECOMMENDATION_TYPE="RecentPhoto"}static{this.FALLBACK_RECENT_RECOMMENDATION_TYPE="RecentPhotos"}static{this.MEDIUM_CAROUSEL_COLLAGE_HEIGHT=180}static{this.LARGE_CAROUSEL_COLLAGE_HEIGHT=288}static{this.MEDIUM_COLLAGE_HEIGHT=204}static{this.LARGE_COLLAGE_HEIGHT=312}static{this.MEDIUM_NEW_COLLAGE_HEIGHT=212}static{this.LARGE_NEW_COLLAGE_HEIGHT=370}static{this.MEDIUM_WIDGET_HEIGHT=308}static{this.LARGE_WIDGET_HEIGHT=416}static{this.MEDIUM_NEW_WIDGET_HEIGHT=308}static{this.LARGE_NEW_WIDGET_HEIGHT=466}static{this.WIDGET_WIDTH=300}static{this.GRID_HEADER_HEIGHT=56}static{this.GRID_HEADER_HEIGHT_NEW_WIDGETSIZE=44}static{this.GRID_HEADER_PADDING="0 24px"}static{this.GRID_HEADER_PADDING_NEW_WIDGETSIZE="0 16px"}getExperienceType(){return z.x.photoCard}carouselFlipperButtonHandler(t){const e=t.detail?.id;try{const t=parseInt(e[e.length-1])-1;this.activeTabIndex=t,this.propertiesApi&&(this.propertiesApi.activationUrl=this.webUrlList[t],this.setSDCardLink(this.propertiesApi.activationUrl))}catch(t){this.propertiesApi&&(this.propertiesApi.activationUrl=this.config.emptyState.callToActionURL,this.setSDCardLink(this.propertiesApi.activationUrl),(0,I.OO)(t,k.TGV,"Failed to parse tabcontentNumber to set activationUrl, so setting to default",JSON.stringify(t)))}}experienceConnected(){try{if(!this.isConnected)return;this.widgetInstance||(this.widgetInstance=(0,v.Qq)()),this.widgetInstance&&(this.setIndexDbKey(),this.lifecycleApi=this.widgetInstance.tryGetApi("lifecycle",v.l1,v.l1),this.lifecycleApi?.addEventListener(this.lifecycleChangeEventHandlerAsync),this.localizedEmptyCtaUrl=this.config.emptyState.callToActionURL,this.config.emptyState.callToActionURL=(0,C.WU)(this.localizedEmptyCtaUrl,this.displayLocale),this.propertiesApi=this.widgetInstance.tryGetApi("properties",v.l1,v.l1),this.propertiesApi&&(this.propertiesApi?.addPropertyChangeListener(this.propertiesChangeEventHandler),this.propertiesApi.attribution=this.strings.poweredByOneDrive,this.propertiesApi.activationUrl=this.config.emptyState.callToActionURL,this.setSDCardLink(this.propertiesApi.activationUrl),this.colorMode=this.propertiesApi?.getProperty("colorMode")??this.colorMode,this.isOffline=this.propertiesApi?.getProperty("offline")??this.isOffline,this.backgroundColor="dark"===this.colorMode?"#2C2C2C":"#FFFFFF",this.position=this.propertiesApi?.getProperty("position"),this.col=this.propertiesApi?.getProperty("column"),this.parentElement?.setAttribute("fill-color",this.backgroundColor)),this.config.isDynamicFeed?(this.cardSize||(this.cardSize=this.getAttribute("cardsize")),this.updateWidgetHeightToWidgetSize(this.cardSize)):(this.sizesApi=this.widgetInstance.tryGetApi("sizes",v.l1,v.l1),this.sizesApi&&(this.sizesApi?.addEventListener(this.sizeChangeEventHandler),this.updateWidgetHeightToWidgetSize(this.sizesApi?.getSize()))),this.statusApi=this.widgetInstance.tryGetApi("status",v.l1,v.l1),this.lastUpdatedDate=new Date,this.visibilityApi=this.widgetInstance.tryGetApi("visibility",v.l1,v.l1),this.visibilityApi?.addEventListener(this.visibilityChangeEventHandler),this.interactionsApi=this.widgetInstance.tryGetApi("interactions",v.l1,v.l1),this.interactionsApi?.addEventListener(this.interactionsHandler),this.indexedDb||this.initializeIndexedDb(),this.photoCardDataService||(this.photoCardDataService=new Ht(this.config,this.displayLocale),this.activeTabIndex=0,this.initializePhotoCard())),this.telemetryContext||this.generateTelemetryTags((0,f.$x)(this.config.isDynamicFeed?this.cardSize:this.sizesApi?.getSize(),this.position,this.col)),this.config.isDynamicFeed&&(this.toggleSDCardActionMenu=this.sdCardActionClickHandler&&(t=>this.toggleCardActionClick(t)),w.Yn.subscribe("Photos",(t=>{t&&this.cardSize!==t.size&&(this.cardSize=t.size,this.updateWidgetHeightToWidgetSize(this.cardSize),this.generateTelemetryTags(null))})),this.isPinned=this.supportedSdCardActionMenuItems&&this.supportedSdCardActionMenuItems.includes(E.B$.Unpin),this.sdCardData={link:this.propertiesApi?this.propertiesApi.activationUrl:this.config.emptyState.callToActionURL,titleContent:this.strings.widgetTitle})}catch(t){const e={...k.yN8,message:"Photos: "+k.yN8.message,pb:{...k.yN8.pb,isPinned:this.isPinned}};(0,I.H)(e,`Photos: error initializing PhotoCard widget: ${t?t.message:""}`)}}disconnectedCallback(){super.disconnectedCallback(),this.lifecycleApi?.removeEventListener(this.lifecycleChangeEventHandlerAsync),this.propertiesApi?.removePropertyChangeListener(this.propertiesChangeEventHandler),this.sizesApi?.removeEventListener(this.sizeChangeEventHandler),this.visibilityApi?.removeEventListener(this.visibilityChangeEventHandler),this.interactionsApi?.removeEventListener(this.interactionsHandler),this.photoCardDataService=null,this.lifecycleApi=null,this.propertiesApi=null,this.sizesApi=null,this.visibilityApi=null,this.interactionsApi=null}updateWidgetHeightToWidgetSize(t){switch(t){case"medium":{const t=this.photoCardData?.length>1?Lt.MEDIUM_CAROUSEL_COLLAGE_HEIGHT:Lt.MEDIUM_COLLAGE_HEIGHT;this.collageHeight=this.isNewWidgetSize()?Lt.MEDIUM_NEW_COLLAGE_HEIGHT:t,this.contentGridRowStart=5,this.widgetHeight=this.isNewWidgetSize()?Lt.MEDIUM_NEW_WIDGET_HEIGHT:Lt.MEDIUM_WIDGET_HEIGHT;break}case"large":{const t=this.photoCardData?.length>1?Lt.LARGE_CAROUSEL_COLLAGE_HEIGHT:Lt.LARGE_COLLAGE_HEIGHT;this.collageHeight=this.isNewWidgetSize()?Lt.LARGE_NEW_COLLAGE_HEIGHT:t,this.contentGridRowStart=7,this.widgetHeight=this.isNewWidgetSize()?Lt.LARGE_NEW_WIDGET_HEIGHT:Lt.LARGE_WIDGET_HEIGHT;break}default:{const{ext:e}=this.telemetryObject&&this.telemetryObject.contract||{};U.M0.sendAppErrorEvent({...k.H_9,message:"Unsupported size for Photo Card, check your widget manifest.",pb:{...k.H_9.pb,widgetSize:void 0===t?"undefined":t,isPinned:!this.config.isDynamicFeed||w.Yn.has("Photos"),templateName:e&&e.template}})}}}async initializeIndexedDb(){this.indexedDb=new H.$;const t=`${(0,S.Yq)().CurrentRequestTargetScope.pageType}.${this.config.indexedDB.id}`;try{await this.indexedDb.initializeIndexedDb(1,`${t}.store`,t)}catch(e){(0,I.OO)(e,k.GB4,`Error while initializing indexedDb with exception. indexedDbPrefix: "${t}", indexedDBkey: "${this.indexedDBkey}".`,JSON.stringify(e))}}async getDataFromIndexedDbAsync(){try{this.indexedDBkey||this.setIndexDbKey();const t=await this.indexedDb.getObject(this.indexedDBkey),e=new Date;return t&&x(e,t.dataDate)?t.data:null}catch(t){const e=null===this.indexedDb;return(0,I.OO)(t,k.GB4,`Failed to get data from indexDb, indexedDBkey: "${this.indexedDBkey}", isIndexedDbNull: "${e}"`,JSON.stringify(t)),null}}setIndexDbKey(){this.widgetInstance&&(this.indexedDBkey=this.widgetInstance.widgetId+this.widgetInstance.instanceId+this.config.indexedDB?.itemId)}async initializePhotoCard(){if(!this.widgetInstance)return;const t=await(0,v.FK)();"consumers"==t?(this.resetIntervalTimer(),await this.getPhotoCardDataAsync(),this.intervalTimer=window.setInterval((()=>this.getPhotoCardDataAsync()),this.config.dataFetchingIntervalInMilliseconds)):(0,I.H)(k.POC,`Unsupported auth for Photo Card, currently Photo Card only support MSA user, accountType: "${t}".`)}resetIntervalTimer(){this.intervalTimer&&clearInterval(this.intervalTimer)}async getPhotoCardDataAsync(){if(!this.widgetInstance)return void(this.photoCardState=y.Error);const t=await this.getDataFromIndexedDbAsync();if(t)this.photoCardData=t;else{const t=await(this.photoCardDataService?.fetchRecommendedItemsDataAsync());if(t?.value){t.value.forEach((t=>{if(t.webUrl&&(t.webUrl=t.webUrl+"&"+this.config.photoCardDataServiceClientSettings.scenario+"&ocid=cmmvacozup5","OnThisDay"===t.recommendation?.recommendationType)){const e=new RegExp(/startDate=((\d+-){2}\d+T(\d+:){2}\d+Z)/),i=new Date,r=t.webUrl?.replace(e,"startDate="+(i.getMonth()+1)+"/"+i.getDate()+"/"+i.getFullYear());t.webUrl=r}})),this.photoCardData=t?.value;const e=new Date;try{this.indexedDBkey||this.setIndexDbKey(),await this.indexedDb.clearObjects(),await this.indexedDb.setObject(this.indexedDBkey,{data:t?.value,dataDate:e}),this.lastUpdatedDate=e}catch(t){(0,I.OO)(t,k.GB4,`Error while writing response to indexedDb cache with exception, indexedDBkey: "${this.indexedDBkey}".`,JSON.stringify(t))}}}this.updateLastUpdatedState(),this.updatePhotoCardState()}getCarouselDataForRecentState(){this.webUrlList=[];const t=T(this.photoCardData);this.propertiesApi&&(this.propertiesApi.activationUrl=t[this.activeTabIndex].webUrl,this.setSDCardLink(this.propertiesApi.activationUrl));return t.map(((t,e)=>{this.webUrlList.push(t.webUrl);const i=F.dy`
                <div part="grid" class="grid">
                    <a part="gridcta-${t=>this.colorMode}" 
                        aria-label="${this.strings.recentPhotoState.callToActionText}"
                        aria-describedby="${this.strings.recentPhotoState.callToActionHint}"
                        class="gridcta"
                        href="${e=>t.webUrl}" 
                        data-t="${this.telemetryContext?.recentPhotoClick?.getMetadataTag()}"
                        target="_blank"
                    >
                        <img 
                            alt=""
                            part="image-content" 
                            class="image-content" 
                            src="${t.url}"
                            data-t="${this.telemetryContext?.recentStateView?.getMetadataTag()}"
                        >
                    </a>
                </div>`,r=F.dy`
            <fluent-card fill-color="${t=>this.backgroundColor}" part="photo-card" class="photo-card" style="
                    --content-grid-height: ${t=>this.widgetHeight}px; 
                    --content-grid-width: ${t=>this.widgetWidth}px; 
                    --content-grid-row-start: ${t=>this.contentGridRowStart};"
                    data-t="${this.telemetryContext?.photoCardView?.getMetadataTag()}">
                ${i}
            </fluent-card>`,o=F.dy`
            <div fill-color="${t=>this.backgroundColor}" part="photo-card" class="photo-card" style="
                    --content-grid-height: ${t=>this.widgetHeight}px; 
                    --content-grid-width: ${t=>this.widgetWidth}px; 
                    --content-grid-row-start: ${t=>this.contentGridRowStart};
                    position: absolute;
                    border: none;"
                    data-t="${this.telemetryContext?.photoCardView?.getMetadataTag()}">
                ${i}
            </div>`;return{tabContent:F.dy`
                    ${(0,W.g)((t=>this.config.isDynamicFeed),o)}
                    ${(0,W.g)((t=>!this.config.isDynamicFeed),r)}`,ariaLabel:`${this.strings.recentPhotoState.carouselTooltip?.replace("{0}",String(e+1))}`}}))}getCarouselDataForMemoriesState(){this.webUrlList=[];const t=this.photoCardData;this.propertiesApi&&(this.propertiesApi.activationUrl=t[this.activeTabIndex].webUrl,this.setSDCardLink(this.propertiesApi.activationUrl));return t.map((t=>{this.webUrlList.push(t.webUrl),this.telemetryContext.mojStateView.contract.name=`${M.MOJ} - ${t.recommendation.recommendationType}`,this.telemetryContext.mojStateView.contract.content.headline=t.recommendation.recommendationType,this.telemetryContext?.collageClick&&(this.telemetryContext.collageClick.contract.content.headline=t.recommendation.recommendationType),this.telemetryContext?.seeAllClick&&(this.telemetryContext.seeAllClick.contract.content.headline=t.recommendation.recommendationType);const e=`${this.telemetryContext?.mojStateView?.getMetadataTag()}`;this.gridHeaderHeight=this.isNewWidgetSize()?Lt.GRID_HEADER_HEIGHT_NEW_WIDGETSIZE:Lt.GRID_HEADER_HEIGHT,this.gridHeaderPadding=this.isNewWidgetSize()?Lt.GRID_HEADER_PADDING_NEW_WIDGETSIZE:Lt.GRID_HEADER_PADDING;const i=F.dy`
            <div part="header" class="header">
                <span part="header-title" class="header-title">
                    ${e=>t.recommendation?.title}
                </span>
                <div part="subheader" class="subheader">
                    <div part="subheader-left" class="subheader-left">
                        ${(0,W.g)((e=>t.recommendation?.recommendationType===_||t.recommendation?.recommendationType===O),F.dy`<span>
                        ${e=>R(t,this.displayLocale)}
                    </span>
                    <span>Â·</span>`)}
                    <span>
                        ${e=>t?.recommendation?.count?this.strings.defaultState.numberOfItemsText?.replace("{0}",String(t.recommendation?.count)):this.strings.defaultState.over100ItemsText}
                    </span>
                    </div>
                    <div>
                        <fluent-anchor
                            appearance="lightweight"
                            class="subheader-right-action"
                            part="subheader-right-action"
                            href="${t.webUrl}" 
                            rel="noopener noreferrer" 
                            target="_blank"
                            aria-label="${this.strings.defaultState.seeAllActionAriaLabel?.replace("{0}",t.recommendation.title)}"
                            aria-describedby="${this.strings.defaultState.seeAllActionHint?.replace("{0}",t.recommendation.title)}"
                            data-t="${this.telemetryContext?.seeAllClick?.getMetadataTag()}"
                        >
                            ${t=>this.strings.defaultState.seeAllActionText}
                        </fluent-anchor>
                    </div>
                </div>
            </div>
            <div part="collage-grid" class="collage-grid" style="height: ${t=>this.collageHeight}px; width: ${t=>this.collageWidth}px;">
                <a
                    href="${e=>t?.webUrl}"
                    part="collage-action-${t=>this.colorMode}"
                    class="collage-action"
                    rel="noopener noreferrer"
                    style="height: ${t=>this.collageHeight}px; width: ${t=>this.collageWidth}px;"
                    target="_blank"
                    aria-label="${this.strings.defaultState.photoCollageAriaLabel?.replace("{0}",t.recommendation.title)}"
                    aria-describedby="${this.strings.defaultState.seeAllActionHint?.replace("{0}",t.recommendation.title)}"
                    data-t="${this.telemetryContext?.collageClick?.getMetadataTag()}"
                >
                    <msft-photo-collage
                        role="img" 
                        height="${t=>this.collageHeight}"
                        width="${t=>this.collageWidth}" 
                        :photos="${e=>D(t)}"
                        data-t="${t=>this.telemetryContext?.mojStateView?e:""}"
                    >
                    </msft-photo-collage>
                </a>
            </div>`,r=F.dy`
            <fluent-card fill-color="${t=>this.backgroundColor}" part="photo-card" class="photo-card" style="
                    --content-grid-height: ${t=>this.widgetHeight}px; 
                    --content-grid-width: ${t=>this.widgetWidth}px; 
                    --content-grid-row-start: ${t=>this.contentGridRowStart};
                    --content-grid-header-height: ${t=>this.gridHeaderHeight}px;
                    --content-grid-header-padding: ${t=>this.gridHeaderPadding};
                    --content-grid-visibility-newwidgetsize: ${t=>this.isNewWidgetSize()?"visible":"hidden"};"
                    data-t="${this.telemetryContext?.photoCardView?.getMetadataTag()}">
                ${i}
            </fluent-card>`,o=F.dy`
            <div fill-color="${t=>this.backgroundColor}" part="photo-card" class="photo-card" style="
                    --content-grid-height: ${t=>this.widgetHeight}px; 
                    --content-grid-width: ${t=>this.widgetWidth}px; 
                    --content-grid-row-start: ${t=>this.contentGridRowStart};
                    --content-grid-header-height: ${t=>this.gridHeaderHeight}px;
                    --content-grid-header-padding: ${t=>this.gridHeaderPadding};
                    --content-grid-visibility-newwidgetsize: ${t=>this.isNewWidgetSize()?"visible":"hidden"};
                    position: absolute;
                    border: none;"
                    data-t="${this.telemetryContext?.photoCardView?.getMetadataTag()}">
                ${i}
            </div>`;return{tabContent:F.dy`
                    ${(0,W.g)((t=>this.config.isDynamicFeed),o)}
                    ${(0,W.g)((t=>!this.config.isDynamicFeed),r)}`,ariaLabel:`${t.recommendation.title}`}}))}updatePhotoCardState(){if(this.photoCardData)try{this.photoCardData[0]?.recommendation?this.photoCardData[0].recommendation?.recommendationType===Lt.FALLBACK_RECOMMENDATION_TYPE||this.photoCardData[0].recommendation?.recommendationType===Lt.FALLBACK_RECENT_RECOMMENDATION_TYPE?(this.photoCardState=this.photoCardData[0].thumbnails?.length>1?y.RecentPhotosCarousel:y.RecentPhoto,this.carouselData=this.getCarouselDataForRecentState()):this.photoCardData[0].recommendation?.recommendationType&&(1===this.photoCardData.length?(this.telemetryContext.mojStateView.contract.name=`${M.MOJ} - ${this.photoCardData[0].recommendation.recommendationType}`,this.telemetryContext.mojStateView.contract.content.headline=this.photoCardData[0].recommendation.recommendationType,this.telemetryContext?.collageClick&&(this.telemetryContext.collageClick.contract.content.headline=this.photoCardData[0].recommendation.recommendationType),this.telemetryContext?.seeAllClick&&(this.telemetryContext.seeAllClick.contract.content.headline=this.photoCardData[0].recommendation.recommendationType),this.propertiesApi&&(this.propertiesApi.activationUrl=this.photoCardData[0].webUrl),this.setSDCardLink(this.photoCardData[0].webUrl),this.photoCardState=y.Memories):(this.updateWidgetHeightToWidgetSize(this.config.isDynamicFeed?this.cardSize:this.sizesApi?.getSize()),this.photoCardState=y.MemoriesCarousel,this.carouselData=this.getCarouselDataForMemoriesState())):(this.photoCardState=y.Empty,this.propertiesApi&&(this.propertiesApi.activationUrl=this.config.emptyState.callToActionURL),this.setSDCardLink(this.config.emptyState.callToActionURL))}catch(t){(0,I.OO)(t,k.obG,"Failed to render template",JSON.stringify(t)),this.photoCardState=y.Error}else this.photoCardState=y.Error;(0,b.MD)(this.getExperienceType()),this.markVisuallyReadyRaf()}updateLastUpdatedState(){x(new Date,this.lastUpdatedDate)?this.statusApi?.hideLastUpdated():this.statusApi?.showLastUpdated(this.lastUpdatedDate)}generateTelemetryTags(t){this.config.isDynamicFeed&&(t=void 0);const e=this.telemetryObject&&this.telemetryObject.contract&&this.telemetryObject.contract.zone||"pinned",i=new _t.D({name:M.PhotoCard,action:N.Aw.View,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),r=new _t.D({name:M.MOJ,action:N.Aw.View,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.RecommendationType},ext:t,zone:e}),o=new _t.D({name:M.RecentPhoto,action:N.Aw.View,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.RecentPhoto},ext:t,zone:e}),a=new _t.D({name:M.EmptyState,action:N.Aw.View,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.EmptyState},ext:t,zone:e}),n=new _t.D({name:M.ErrorState,action:N.Aw.View,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.ErrorState},ext:t,zone:e}),s=new _t.D({name:M.Collage,action:N.Aw.Click,behavior:N.wu.Navigate,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.RecommendationType},ext:t,zone:e}),d=new _t.D({name:M.SeeAll,action:N.Aw.Click,behavior:N.wu.Navigate,content:{type:N.uH.StructuredData,vertical:M.Vertical,headline:M.RecommendationType},ext:t,zone:e}),c=new _t.D({name:M.ViewOnOneDrive,action:N.Aw.Click,behavior:N.wu.Navigate,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),h=new _t.D({name:M.GetMobileApp,action:N.Aw.Click,behavior:N.wu.Navigate,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),l=new _t.D({name:M.CardActionButton,action:N.Aw.Click,behavior:N.wu.ContextMenu,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),p=new _t.D({name:M.CarouselNextFlipperButton,action:N.Aw.Click,behavior:N.wu.Seek,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),g=new _t.D({name:M.CarouselPreviousFlipperButton,action:N.Aw.Click,behavior:N.wu.Seek,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e}),u=new _t.D({name:M.HeaderLink,action:N.Aw.Click,behavior:N.wu.Navigate,type:N.c9.ActionButton,content:{type:N.uH.StructuredData,vertical:M.Vertical},ext:t,zone:e});this.telemetryContext={componentRoot:this.telemetryObject,photoCardView:i,mojStateView:r,recentStateView:o,emptyStateView:a,errorStateView:n,collageClick:s,seeAllClick:d,recentPhotoClick:c,emptyPhotoClick:h,cardActionButton:l,nextFlipperClick:p,previousFlipperClick:g,headerClick:u}}toggleCardActionClick(t){if(t){const e=t.currentTarget,{ext:i}=this.telemetryObject&&this.telemetryObject.contract||{},r=M.Vertical,o={menuItems:(0,E.aS)(this.supportedSdCardActionMenuItems,this.strings.poweredByOneDrive,i,r,this.cardSize),referrerButton:e,cardSize:this.cardSize,onSdCardMenuOpenChanged:t=>{this.isActionMenuOpen=t}};this.sdCardActionClickHandler(o,"Photos")}}isNewWidgetSize(){return this.config.isDynamicFeed}setSDCardLink(t){this.config.isDynamicFeed&&(this.sdCardData&&this.sdCardData.link?this.sdCardData.link=t:this.sdCardData={link:t,titleContent:this.strings.widgetTitle})}}(0,m.gn)([Mt.LO],Lt.prototype,"photoCardData",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"colorMode",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"displayLocale",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"collageHeight",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"widgetHeight",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"photoCardState",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"telemetryContext",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"carouselData",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"isActionMenuOpen",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"toggleSDCardActionMenu",void 0),(0,m.gn)([Mt.LO],Lt.prototype,"isPinned",void 0);const Pt=F.dy`<span></span>`,It={[y.Empty]:F.dy` ${t=>F.dy`<img alt="${t.config.emptyState.image.altText}" class="image" src="${t.config.emptyState.image.url+A(t.config.staticBackgroundImageNames)}" data-t="${t=>t.telemetryContext?.emptyStateView?.getMetadataTag()}">`} `,[y.Error]:F.dy` ${t=>F.dy`<img alt="${t.config.errorState.image.altText}" class="image" src="${t.config.errorState.image.url+A(t.config.staticBackgroundImageNames)}" data-t="${t=>t.telemetryContext?.errorStateView?.getMetadataTag()}">`} `,[y.Memories]:F.dy`${Pt}`,[y.RecentPhoto]:F.dy`${Pt}`,[y.MemoriesCarousel]:F.dy`${Pt}`,[y.RecentPhotosCarousel]:F.dy`${Pt}`},kt={[y.Empty]:F.dy` ${t=>F.dy`<div class="top-overlay overlay-${t=>t.colorMode}"></div>`} `,[y.Error]:F.dy` ${t=>F.dy`<div class="top-overlay overlay-${t=>t.colorMode}"></div>`} `,[y.Memories]:F.dy`${Pt}`,[y.RecentPhoto]:F.dy`${Pt}`,[y.MemoriesCarousel]:F.dy`${Pt}`,[y.RecentPhotosCarousel]:F.dy`${Pt}`},Ut={[y.Empty]:F.dy`<span>${t=>t.strings.emptyState.messageText}</span>`,[y.Error]:F.dy`<span>${t=>t.strings.errorState.messageText}</span>`,[y.Memories]:F.dy`${Pt}`,[y.RecentPhoto]:F.dy`${Pt}`,[y.MemoriesCarousel]:F.dy`${Pt}`,[y.RecentPhotosCarousel]:F.dy`${Pt}`},Nt={[y.Empty]:F.dy`<fluent-anchor appearance="neutral" class="action" href="${t=>t.config.emptyState.callToActionURL}" rel="noopener noreferrer" target="_blank" data-t="${t=>t.telemetryContext?.emptyPhotoClick?.getMetadataTag()}" style="border-radius:4px">${t=>t.strings.emptyState.callToActionText}</fluent-anchor>`,[y.Error]:F.dy`${Pt}`,[y.Memories]:F.dy`${Pt}`,[y.RecentPhoto]:F.dy`${Pt}`,[y.MemoriesCarousel]:F.dy`${Pt}`,[y.RecentPhotosCarousel]:F.dy`${Pt}`},Ft=F.dy`<fluent-design-system-provider fill-color="#242424" class="content"><div class="content-message">${t=>Ut[t.photoCardState]}</div><div class="content-action">${t=>Nt[t.photoCardState]}</div></fluent>`,Wt={[y.Memories]:F.dy`${Pt}`,[y.RecentPhoto]:F.dy`${Pt}`,[y.Empty]:F.dy`${Ft}`,[y.Error]:F.dy`${Ft}`,[y.MemoriesCarousel]:F.dy`${Pt}`,[y.RecentPhotosCarousel]:F.dy`${Pt}`},zt=F.dy`<div class="grid">${t=>It[t.photoCardState]} ${t=>kt[t.photoCardState]} ${t=>Wt[t.photoCardState]}</div>`,Gt=F.dy`<div class="header"><span class="header-title">${t=>t.photoCardData[0].recommendation?.title}</span><div class="subheader"><div class="subheader-left">${(0,W.g)((t=>t.photoCardData[0].recommendation?.recommendationType===_||t.photoCardData[0].recommendation?.recommendationType===O),F.dy`<span>${t=>R(t.photoCardData[0],t.displayLocale)}</span><span>Â·</span>`)}<span>${t=>{const e=t.photoCardData[0]?.recommendation?.count;return e?t.strings.defaultState.numberOfItemsText.replace("{0}",String(t.photoCardData[0].recommendation?.count)):t.strings.defaultState.over100ItemsText}}</span></div><div><fluent-anchor appearance="lightweight" class="subheader-right-action" href="${t=>t.photoCardData[0].webUrl}" rel="noopener noreferrer" target="_blank" aria-label="${t=>t.strings.defaultState.seeAllActionAriaLabel?.replace("{0}",t.photoCardData[0].recommendation.title)}" aria-describedby="${t=>t.strings.defaultState.seeAllActionHint?.replace("{0}",t.photoCardData[0].recommendation.title)}" data-t="${t=>t.telemetryContext?.seeAllClick?.getMetadataTag()}">${t=>t.strings.defaultState.seeAllActionText}</fluent-anchor></div></div></div><a href="${t=>t.photoCardData[0].webUrl}" rel="noopener noreferrer" class="collage" style="height: ${t=>t.collageHeight}px; width: ${t=>t.collageWidth}px;" target="_blank" aria-label="${t=>t.strings.defaultState.photoCollageAriaLabel?.replace("{0}",t.photoCardData[0].recommendation.title)}" aria-describedby="${t=>t.strings.defaultState.seeAllActionHint?.replace("{0}",t.photoCardData[0].recommendation.title)}" data-t="${t=>t.telemetryContext?.collageClick?.getMetadataTag()}"><msft-photo-collage role="img" height="${t=>t.collageHeight}" width="${t=>t.collageWidth}" :photos="${t=>D(t.photoCardData[0])}" data-t="${t=>t.telemetryContext?.mojStateView?.getMetadataTag()}"></msft-photo-collage></a>`,qt=F.dy`<div class="grid"><a aria-label="${t=>t.strings.recentPhotoState.callToActionText}" aria-describedby="${t=>t.strings.recentPhotoState.callToActionHint}" class="gridcta overlay-${t=>t.colorMode}" href="${t=>{const e=T(t.photoCardData);return e[0]?e[0].webUrl:""}}" data-t="${t=>t.telemetryContext?.recentPhotoClick?.getMetadataTag()}" target="_blank"><img alt="" class="image-content" src="${t=>{const e=T(t.photoCardData);return e[0]?e[0].url:""}}" data-t="${t=>t.telemetryContext?.recentStateView?.getMetadataTag()}"></a></div>`;var Bt=i(53271),jt=i(94522);const Vt=F.dy`<fluent-card fill-color="${t=>t.backgroundColor}" class="photo-card" style=" --content-grid-height: ${t=>t.widgetHeight}px; --content-grid-width: ${t=>t.widgetWidth}px; --content-grid-row-start: ${t=>t.contentGridRowStart};">${zt}</fluent-card>`,Xt=F.dy`<div fill-color="${t=>t.backgroundColor}" class="photo-card" style=" --content-grid-height: ${t=>t.widgetHeight}px; --content-grid-width: ${t=>t.widgetWidth}px; --content-grid-row-start: ${t=>t.contentGridRowStart}; position: absolute; border: none;">${zt}</div>`,Qt=F.dy`<fluent-card background-color="${t=>t.backgroundColor}" class="photo-card" style=" --content-grid-height: ${t=>t.widgetHeight}px; --content-grid-width: ${t=>t.widgetWidth}px; --content-grid-row-start: ${t=>t.contentGridRowStart};" data-t="${t=>t.telemetryContext?.photoCardView?.getMetadataTag()}">${(0,W.g)((t=>t.photoCardState===y.Memories),Gt)} ${(0,W.g)((t=>t.photoCardState===y.RecentPhoto),qt)}</fluent-card>`,Yt=F.dy`<div background-color="${t=>t.backgroundColor}" class="photo-card" style=" --content-grid-height: ${t=>t.widgetHeight}px; --content-grid-width: ${t=>t.widgetWidth}px; --content-grid-row-start: ${t=>t.contentGridRowStart}; position: absolute; border: none;" data-t="${t=>t.telemetryContext?.photoCardView?.getMetadataTag()}">${(0,W.g)((t=>t.photoCardState===y.Memories),Gt)} ${(0,W.g)((t=>t.photoCardState===y.RecentPhoto),qt)}</div>`,Jt=F.dy`<msft-carousel-card class="photos-msft-carousel-card" :contentData=${t=>t.carouselData} @change=${(t,e)=>t.carouselFlipperButtonHandler(e.event)} style="${t=>t.config.isDynamicFeed?"position: absolute;":"height:"+t.widgetHeight+"px;"}" :previousFlipperTelemetryTag=${t=>t.telemetryContext?.nextFlipperClick?.getMetadataTag()} :nextFlipperTelemetryTag=${t=>t.telemetryContext?.previousFlipperClick?.getMetadataTag()}></msft-carousel-card>`,Zt={[y.Empty]:F.dy` ${(0,W.g)((t=>t.config.isDynamicFeed),Xt)} ${(0,W.g)((t=>!t.config.isDynamicFeed),Vt)}`,[y.Error]:F.dy` ${(0,W.g)((t=>t.config.isDynamicFeed),Xt)} ${(0,W.g)((t=>!t.config.isDynamicFeed),Vt)}`,[y.Memories]:F.dy` ${(0,W.g)((t=>t.config.isDynamicFeed),Yt)} ${(0,W.g)((t=>!t.config.isDynamicFeed),Qt)}`,[y.RecentPhoto]:F.dy` ${(0,W.g)((t=>t.config.isDynamicFeed),Yt)} ${(0,W.g)((t=>!t.config.isDynamicFeed),Qt)}`,[y.MemoriesCarousel]:F.dy`${Jt}`,[y.RecentPhotosCarousel]:F.dy`${Jt}`},Kt=F.dy`${(0,W.g)((t=>t.config.isDynamicFeed&&t.isPinned),F.dy`<div class="pinned-icon" slot="pin" role="img" aria-label="${t=>t.strings.pinnedWidgetText||"pinned widget"}"> ${F.dy.partial(jt.Z)} </div>`)}`,te=F.dy` ${(0,W.g)((t=>t.toggleSDCardActionMenu),F.dy`<fluent-button class="more-options" aria-label="${t=>t.strings.moreOptions}" role="button" aria-expanded="false" slot="more-actions" appearance="neutral" @click="${(t,e)=>t.toggleSDCardActionMenu(e.event)}" data-t="${t=>t.telemetryContext?.cardActionButton?.getMetadataTag()}">${F.dy.partial(Bt.Z)}</fluent-button>`)}
`,ee=F.dy`<msft-prong2-card-wrapper class="card" style="border:none;"><msft-structured-data-card class="sd-card-template" :data=${t=>t.sdCardData} target="_blank" style="--content-grid-width: ${t=>t.widgetWidth}px;" ?pinned="${t=>t.isPinned}" :headerTelemetryTag="${t=>t.telemetryContext?.headerClick?.getMetadataTag()}"><div slot="title-icon">${F.dy.partial('<svg width="16" height="16" viewBox="0 0 2048 2048"><path fill="#0364B8" d="M505 640q43-65 101-118 57-53 126-91t147-58q77-21 161-21 112 0 213 36t183 101q81 64 139 152t85 192l-449 246z"/><path fill="#0078D4" d="m1211 974-390 471H92q-44-63-68-137T0 1152q0-105 40-197 39-93 108-162 68-70 160-111t197-42h5q76 0 144 21 67 20 127 55z"/><path fill="#1490DF" d="M1660 833q81 5 152 40 71 34 124 90 52 56 82 130 30 73 30 155 0 54-13 104-13 49-37 93l-563-95-224-376 256-108q37-15 76-24 39-10 81-10h21q7 0 15 1z"/><path fill="#28A8EA" d="M1211 974q216 129 388 232 73 44 144 86 70 42 126 76 55 33 91 55 35 21 38 22-26 49-64 90-39 40-86 69-47 28-102 44t-114 16H512q-63 0-122-15-60-15-114-43-54-29-101-69-47-41-84-92z"/></svg>')}</div>${Kt} ${te} ${t=>Zt[t.photoCardState]}</msft-structured-data-card></msft-prong2-card-wrapper>`,ie=F.dy` ${te} ${t=>Zt[t.photoCardState]}`,re=F.dy` ${(0,W.g)((t=>t.config.isDynamicFeed),ee)} ${(0,W.g)((t=>!t.config.isDynamicFeed),ie)}`;var oe=i(22798),ae=i(78923),ne=i(29717),se=i(32572),de=i(27782);const ce=ae.i` .grid{--background:inherit;--top-overlay-height:86px;display:grid;grid-template-columns:repeat(12,1fr);grid-template-rows:repeat(12,1fr);height:var(--content-grid-height);width:var(--content-grid-width);position:relative}.photos-msft-carousel-card::part(grid){--background:inherit;--top-overlay-height:86px;--bottom-overlay-height:56px;display:grid;grid-template-columns:repeat(12,1fr);grid-template-rows:repeat(12,1fr);height:var(--content-grid-height);width:var(--content-grid-width);position:relative}.photos-msft-carousel-card::part(gridcta-light){grid-area:1 / 1 / -1 / -1;position:relative}.photos-msft-carousel-card::part(gridcta-dark){grid-area:1 / 1 / -1 / -1;position:relative}.photos-msft-carousel-card::part(gridcta-light)::after{background:var(--background);content:'';position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width);--background:linear-gradient(180deg,rgba(255,255,255,0.6) 0,rgba(255,255,255,0.5) calc(var(--top-overlay-height) * .4922),rgba(255,255,255,0) calc(var(--top-overlay-height) * .9774));z-index:0}.photos-msft-carousel-card::part(gridcta-light)::before{background:var(--background);content:'';--background:linear-gradient( 1.14deg,rgba(255,255,255,0.6) calc(var(--bottom-overlay-height) * 0.0104),rgba(255,255,255,0.54) calc(var(--bottom-overlay-height) * 0.4106),rgba(255,255,255,0) calc(var(--bottom-overlay-height) * 0.9045) );position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width)}.photos-msft-carousel-card::part(gridcta-dark)::after{background:var(--background);content:'';position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width);--background:linear-gradient(180deg,rgba(0,0,0,0.54) 0,rgba(0,0,0,0.54) calc(var(--top-overlay-height) * .372),rgba(0,0,0,0) var(--top-overlay-height));z-index:0}.photos-msft-carousel-card::part(gridcta-dark)::before{background:var(--background);content:'';--background:linear-gradient( 1.14deg,rgba(0,0,0,0.6) calc(var(--bottom-overlay-height) * 0.0104),rgba(0,0,0,0.54) calc(var(--bottom-overlay-height) * 0.4106),rgba(0,0,0,0) calc(var(--bottom-overlay-height) * 0.9045) );position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width)}.photos-msft-carousel-card::part(image-content){grid-column:1 / -1;grid-row:1 / -1;height:100%;width:100%;object-fit:cover}.photos-msft-carousel-card::part(gridcta-light):hover{opacity:80%}.photos-msft-carousel-card::part(gridcta-dark):hover{opacity:80%}.photos-msft-carousel-card::part(image-content):hover{opacity:80%}.photos-msft-carousel-card::part(image){grid-column:1 / -1;grid-row:1 / -1;height:100%;width:100%;object-fit:cover}.photos-msft-carousel-card::part(image):hover{opacity:80%}.photos-msft-carousel-card::part(top-overlay){--background:inherit;--top-overlay-height:86px;background:var(--background);grid-column:1 / -1;grid-row:1 / var(--content-grid-row-start)}.photos-msft-carousel-card::part(top-overlay-dark){--background:inherit;--top-overlay-height:86px;background:var(--background);grid-column:1 / -1;grid-row:1 / var(--content-grid-row-start);--background:linear-gradient(180deg,rgba(0,0,0,0.54) 0,rgba(0,0,0,0.54) calc(var(--top-overlay-height) * .372),rgba(0,0,0,0) var(--top-overlay-height));z-index:0}.photos-msft-carousel-card::part(top-overlay-light){--background:inherit;--top-overlay-height:86px;background:var(--background);grid-column:1 / -1;grid-row:1 / var(--content-grid-row-start);--background:linear-gradient(180deg,rgba(255,255,255,0.6) 0,rgba(255,255,255,0.5) calc(var(--top-overlay-height) * .4922),rgba(255,255,255,0) calc(var(--top-overlay-height) * .9774));z-index:0}.gridcta{grid-area:1 / 1 / -1 / -1;position:relative}.gridcta:hover{opacity:80%}.gridcta::after{background:var(--background);content:'';position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width)}.image-content{grid-column:1 / -1;grid-row:1 / -1;height:100%;width:100%;object-fit:cover}.image-content:hover{opacity:80%}.top-overlay{background:var(--background);grid-column:1 / -1;grid-row:1 / var(--content-grid-row-start)}.overlay-dark{--background:linear-gradient(180deg,rgba(0,0,0,0.54) 0,rgba(0,0,0,0.54) calc(var(--top-overlay-height) * .372),rgba(0,0,0,0) var(--top-overlay-height));z-index:0}.overlay-light{--background:linear-gradient(180deg,rgba(255,255,255,0.6) 0,rgba(255,255,255,0.5) calc(var(--top-overlay-height) * .4922),rgba(255,255,255,0) calc(var(--top-overlay-height) * .9774));z-index:0}.image{grid-column:1 / -1;grid-row:1 / -1;height:100%;width:100%;object-fit:cover}.content{--content-spacing:24px;grid-column:1 / -1;grid-row:var(--content-grid-row-start) / -1;background:linear-gradient(1.14deg,rgba(0,0,0,0.72) 1.04%,rgba(0,0,0,0.62) 44.66%,rgba(0,0,0,0) 90.45%);flex-grow:1;display:flex;flex-direction:column;justify-content:flex-end}.content-message{--content-message-padding-top:16px;display:flex;flex-direction:column;justify-content:flex-end;font-size:${se.P};font-weight:600;line-height:${de.R};text-align:center;padding:var(--content-message-padding-top) var(--content-spacing) 0}.content-action{--content-action-height:56px;--content-action-top-padding:14px;display:flex;justify-content:center;font-size:${se.P};line-height:${de.R};height:calc(var(--content-action-top-padding) + var(--content-action-height));padding:var(--content-action-top-padding) var(--content-spacing) var(--content-spacing)}.content-action-only{--content-action-top-padding:24px}`.withBehaviors((0,ne.vF)(ae.i` .top-overlay{background:${oe.H.Canvas};height:var(--app-attribution-area-height)}.content{background:none;box-shadow:none;color:${oe.H.CanvasText}}.content-message{background:${oe.H.Canvas}}.content-action{background:${oe.H.Canvas}}.action[appearance="neutral"]::part(control){background-color:${oe.H.ButtonFace};border-color:${oe.H.ButtonText};color:${oe.H.ButtonText}}.action{border-radius:4px}`));var he=i(16549),le=i(74449);const pe=ae.i` .header{display:flex;flex-direction:column;align-items:stretch;height:56px;margin-top:var(--app-attribution-area-height);padding:0 24px}.header-title{font-size:${se.P};font-weight:600;font-style:normal;line-height:${de.R};height:${de.R}}.subheader{display:flex;justify-content:space-between;align-items:center;font-size:${he.s};font-weight:400;line-height:${he.v};height:${he.v}}.subheader-left{color:${le.Q};display:flex;gap:4px}.photo-card{border-radius:var(--photo-card-border-radius);display:flex;flex-direction:column;position:relative;height:100%;width:100%}.subheader-right-action[appearance="lightweight"]::part(content){font-size:${he.s};line-height:${he.v}}.collage-action[appearance="stealth"]::part(content){height:100%;width:100%}.collage:hover{opacity:80%}.collage-action[appearance="stealth"]::part(control){border:none;padding:0}`.withBehaviors((0,ne.vF)(ae.i` .header{color:${oe.H.CanvasText}}.subheader-left{color:inherit}.subheader-right-action[appearance="lightweight"]::part(control){color:${oe.H.LinkText}}.collage-action[appearance="stealth"]::part(control){background-color:${oe.H.ButtonFace}}`));var ge=i(42689);const ue=ae.i` :host{--app-attribution-area-height:48px;--photo-card-border-radius:8px;--content-padding:0px;border-radius:var(--photo-card-border-radius)}:host *{box-sizing:border-box}.photo-card-container{border-radius:var(--photo-card-border-radius);height:100%;width:100%}.collage-grid{--background:inherit;--bottom-overlay-height:56px;display:grid;grid-template-columns:repeat(12,1fr);grid-template-rows:repeat(12,1fr);position:relative}.photos-msft-carousel-card::part(photo-card){border-radius:var(--photo-card-border-radius);display:flex;flex-direction:column;position:relative;height:100%;width:100%}.photos-msft-carousel-card::part(header){display:flex;flex-direction:column;align-items:stretch;height:var(--content-grid-header-height);margin-top:var(--app-attribution-area-height);padding:var(--content-grid-header-padding)}.photos-msft-carousel-card::part(header-title){font-size:${se.P};font-weight:600;font-style:normal;line-height:${de.R};height:${de.R}}.photos-msft-carousel-card::part(subheader){display:flex;justify-content:space-between;align-items:center;font-size:${he.s};font-weight:400;line-height:${he.v};height:${he.v}}.photos-msft-carousel-card::part(subheader-left){color:${le.Q};display:flex;gap:4px}.photos-msft-carousel-card::part(subheader-right-action){font-size:${he.s};line-height:${he.v}}.photos-msft-carousel-card::part(content){height:100%;width:100%}.photos-msft-carousel-card::part(collage-grid){--background:inherit;--bottom-overlay-height:56px;display:grid;grid-template-columns:repeat(12,1fr);grid-template-rows:repeat(12,1fr);position:relative}.photos-msft-carousel-card::part(collage-action-light):hover{opacity:80%}.photos-msft-carousel-card::part(collage-action-dark):hover{opacity:80%}.photos-msft-carousel-card::part(collage-action-light){grid-area:1 / 1 / -1 / -1;position:relative}.photos-msft-carousel-card::part(collage-action-dark){grid-area:1 / 1 / -1 / -1;position:relative}.photos-msft-carousel-card::part(collage-action-light)::before{visibility:var(--content-grid-visibility-newwidgetsize);background:var(--background);content:'';--background:linear-gradient( 1.14deg,rgba(255,255,255,0.6) calc(var(--bottom-overlay-height) * 0.0104),rgba(255,255,255,0.54) calc(var(--bottom-overlay-height) * 0.4106),rgba(255,255,255,0) calc(var(--bottom-overlay-height) * 0.9045) );position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width)}.photos-msft-carousel-card::part(collage-action-dark)::before{visibility:var(--content-grid-visibility-newwidgetsize);background:var(--background);content:'';--background:linear-gradient( 1.14deg,rgba(0,0,0,0.6) calc(var(--bottom-overlay-height) * 0.0104),rgba(0,0,0,0.54) calc(var(--bottom-overlay-height) * 0.4106),rgba(0,0,0,0) calc(var(--bottom-overlay-height) * 0.9045) );position:absolute;top:0;left:0;bottom:0;width:var(--content-grid-width)}.photos-msft-carousel-card::part(control){border:none;padding:0}.pinned-icon{inset-inline-start:234px;background:transparent;fill:${ge.C}}.sd-card-template::part(title){z-index:2;--title-padding:10px 16px 0}msft-structured-data-card[pinned]::part(title){--title-padding:16px 16px 0}${ce} ${pe}
`.withBehaviors((0,ne.vF)(ae.i` .header{color:${oe.H.CanvasText}}.subheader-left{color:inherit}.subheader-right-action[appearance="lightweight"]::part(control){color:${oe.H.LinkText}}.collage-action[appearance="stealth"]::part(control){background-color:${oe.H.ButtonFace}}`)),ye={experienceConfigSchema:undefined};r.D.define(o.H.registry),a.D.define(o.H.registry),n.D.define(o.H.registry),s.hg.define(d.j.registry),c.M9.define(d.j.registry),h.mL.define(d.j.registry),l.ok.define(d.j.registry),p.gn.define(d.j.registry),g.xb.define(d.j.registry),u.g.define(d.j.registry)},94522:function(t,e){e.Z='<svg width="12" height="12" viewBox="0 0 2048 2048" role="presentation"><path d="M2014 853q0 58-32 106t-86 70l-535 223q-13 5-23 15t-14 25l-175 582q-6 20-22 33t-39 13q-26 0-45-19l-403-403-550 550H0v-91l550-549-403-403q-19-19-19-46 0-19 11-35t29-23l593-237q23-9 34-33l222-489q23-52 71-82t105-31q38 0 73 15t62 41l630 631q27 27 41 63t15 74zm-821-696q-20 0-35 10t-24 28L912 684q-15 34-42 59t-62 40L306 983l751 752 144-479q12-41 41-73t69-49l536-224q18-8 28-23t11-36q0-27-18-45l-631-630q-19-19-44-19z"/></svg>'},92449:function(t,e,i){i.d(e,{Er:function(){return d},hg:function(){return f},U7:function(){return v}});var r=i(33940),o=i(28904),a=i(42590),n=i(99452);const s=new Map([[1,[[{x:0,y:0,gridWidth:12,gridHeight:12}]]],[2,[[{x:0,y:0,gridWidth:12,gridHeight:6},{x:0,y:1,gridWidth:12,gridHeight:6}],[{x:0,y:0,gridWidth:6,gridHeight:12},{x:1,y:0,gridWidth:6,gridHeight:12}]]],[3,[[{x:0,y:0,gridWidth:12,gridHeight:6},{x:0,y:1,gridWidth:6,gridHeight:6},{x:1,y:1,gridWidth:6,gridHeight:6}],[{x:0,y:0,gridWidth:6,gridHeight:12},{x:1,y:0,gridWidth:6,gridHeight:6},{x:1,y:1,gridWidth:6,gridHeight:6}]]],[4,[[{x:0,y:0,gridWidth:12,gridHeight:8},{x:0,y:1,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4}],[{x:0,y:0,gridWidth:8,gridHeight:12},{x:1,y:0,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4},{x:1,y:2,gridWidth:4,gridHeight:4}],[{x:0,y:0,gridWidth:6,gridHeight:12},{x:1,y:0,gridWidth:6,gridHeight:6},{x:1,y:1,gridWidth:3,gridHeight:6},{x:1,y:2,gridWidth:3,gridHeight:6}],[{x:0,y:0,gridWidth:6,gridHeight:6},{x:1,y:0,gridWidth:6,gridHeight:6},{x:0,y:1,gridWidth:6,gridHeight:6},{x:1,y:1,gridWidth:6,gridHeight:6}],[{x:0,y:0,gridWidth:8,gridHeight:6},{x:1,y:0,gridWidth:4,gridHeight:6},{x:0,y:1,gridWidth:8,gridHeight:6},{x:1,y:1,gridWidth:4,gridHeight:6}]]],[5,[[{x:0,y:0,gridWidth:8,gridHeight:6},{x:1,y:0,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4},{x:0,y:2,gridWidth:8,gridHeight:6},{x:1,y:2,gridWidth:4,gridHeight:4}],[{x:0,y:0,gridWidth:6,gridHeight:6},{x:1,y:0,gridWidth:6,gridHeight:6},{x:1,y:1,gridWidth:4,gridHeight:6},{x:1,y:1,gridWidth:4,gridHeight:6},{x:1,y:1,gridWidth:4,gridHeight:6}],[{x:0,y:0,gridWidth:8,gridHeight:8},{x:1,y:0,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4},{x:0,y:2,gridWidth:8,gridHeight:4},{x:1,y:2,gridWidth:4,gridHeight:4}],[{x:0,y:0,gridWidth:8,gridHeight:8},{x:1,y:0,gridWidth:4,gridHeight:8},{x:0,y:1,gridWidth:4,gridHeight:4},{x:1,y:1,gridWidth:4,gridHeight:4},{x:2,y:1,gridWidth:4,gridHeight:4}]]]]);class d extends o.H{constructor(){super(...arguments),this.photos=[],this.layout=[]}heightChanged(){this.$fastController.isConnected&&(this.layout=this.getBestCollageLayoutWithPhotos())}widthChanged(){this.$fastController.isConnected&&(this.layout=this.getBestCollageLayoutWithPhotos())}photosChanged(){this.$fastController.isConnected&&(this.layout=this.getBestCollageLayoutWithPhotos())}connectedCallback(){super.connectedCallback(),this.layout=this.getBestCollageLayoutWithPhotos()}getStyles(t){return`grid-column:span ${t.gridWidth}; grid-row:span ${t.gridHeight};`}getSumOfAspectRatiosForPhotos(){let t=0;return this.photos.forEach((e=>{isNaN(e.height)||isNaN(e.width)||new TypeError,t+=e.width/e.height})),t}getSumOfCollageCellsAspectRatios(t){let e=0;const i=this.width/12,r=this.height/12;return t.forEach((t=>{e+=t.gridWidth*i/(t.gridHeight*r)})),e}getLayoutsAvailable(){if(0===this.photos.length)return[];const t=s.get(Math.min(5,this.photos.length));if(!t)throw new Error("This layout isn't supported");return t}getBestCollageLayoutWithPhotos(){const t=this.getLayoutsAvailable();let e=0;const i=this.getSumOfAspectRatiosForPhotos();let r=Number.MAX_VALUE;if(0===t.length)return[];t.forEach(((t,o)=>{const a=this.getSumOfCollageCellsAspectRatios(t);Math.abs(i-a)<r&&(r=Math.abs(i-a),e=o)}));const o=[...t[e]];return this.assignPhotosToLayout(o),o}assignPhotosToLayout(t){const e=[...this.photos];t.length>1&&(t.sort(((t,e)=>t.gridWidth/t.gridHeight>e.gridWidth/e.gridHeight?1:-1)),e.sort(((t,e)=>t.width/t.height>e.width/e.height?1:-1))),t.forEach(((i,r)=>{t[r]={x:i.x,y:i.y,gridWidth:i.gridWidth,gridHeight:i.gridHeight,photo:e[r]}})),t.sort(((t,e)=>t.y>e.y||t.x>e.x?1:-1))}}(0,r.gn)([a.Lj],d.prototype,"height",void 0),(0,r.gn)([a.Lj],d.prototype,"width",void 0),(0,r.gn)([n.LO],d.prototype,"photos",void 0),(0,r.gn)([n.LO],d.prototype,"layout",void 0);var c=i(49218),h=i(93703),l=i(89150);const p=c.dy`
${(0,h.g)((t=>0!==t.photos.length),c.dy`<template>${(0,l.rx)((t=>t.layout),c.dy`<span style=${(t,e)=>e.parent.getStyles(t)}><img class="img" alt=${t=>t.photo?.alt} src=${t=>t.photo?.url} /></span>`)}</template>`)}`;var g=i(78923),u=i(27186);const y=g.i` .img{width:100%;height:100%;object-fit:cover}${(0,u.j)("grid")} :host{grid-template-columns:repeat(${12..toString()},minmax(0,1fr));grid-template-rows:repeat(${12..toString()},minmax(0,1fr));grid-gap:2px;height:100%}`;var m=i(23335);const f=d.compose({name:`${m.j.prefix}-photo-collage`,template:p,styles:y}),v=y},14318:function(t,e,i){i.d(e,{g:function(){return h},I:function(){return l}});var r=i(32229),o=i(78923),a=i(35928),n=i(23335),s=i(79850),d=i(55135);const c=o.i` ${s.W} :host{border-radius:calc(${d.rS} * 1px);box-shadow:0px 2px 4px rgba(0,0,0,0.04)}`,h=r.u.compose({name:`${n.j.prefix}-prong2-card-wrapper`,template:(0,a.O)(),styles:c}),l=r.u.compose({name:`${n.j.prefix}-mstf-prong2-card-wrapper`,template:(0,a.O)(),styles:o.i`
    ${c}
    :host {
        box-shadow: 0 0 calc((var(--elevation) * 0.225px) + 2px) rgba(0, 0, 0, calc(0.11 * (2 - var(--background-luminance, 1)))), 0 calc(var(--elevation) * 0.4px) calc((var(--elevation) * 0.9px)) rgba(0, 0, 0, calc(0.13 * (2 - var(--background-luminance, 1))));
    }`})}}]);